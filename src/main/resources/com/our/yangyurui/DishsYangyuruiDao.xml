<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yangyurui.dao.DishsYangyuruiDao">
	<!--查询全部菜品数量-->
	<select id="getCurrentDishNumber" resultType="int">
		select count(*) from dishs
	</select>

	<!--查询全部菜品-->
	<select id="listDishs" resultType="com.our.pojo.Dishs">
		select * from dishs
	</select>
	
	<!-- 根据关键字查询菜品 -->
	<select id="listDishsByKey" parameterType="String" resultType="com.our.pojo.Dishs">
		select dishs_delete,dishs.dishs_id,dishs_name,dishs_cate,dishs_icon,price,introduction,recommend
		 from dishs join dishs_detail on dishs.dishs_id=dishs_detail.dishs_id
		 where dishs_name like #{key} or dishs_cate like #{key} or introduction like #{key}
		 	or introduce_detail like #{key} or taste like #{key}
	</select>
	<!-- 按id查询菜品 -->
	<select id="getDishByDishId" parameterType="int" resultType="com.our.pojo.Dishs">
		select * from dishs where dishs_id=#{dishId}
	</select>
	<!-- 根据菜类查询菜品 -->
	<select id="listDishsByCategory" parameterType="String" resultType="com.our.pojo.Dishs">
			select * from dishs where dishs_cate=#{category}
	</select>
	<!-- 查询非招牌菜类的菜 -->
	<select id="listOtherDishs" resultType="com.our.pojo.Dishs">
			select * from dishs where dishs_cate!='美味闷锅' and dishs_cate!='热乎炒菜' 
			and dishs_cate!='湘菜系谱' and dishs_cate!='经典水煮' and dishs_cate!='飘香煮菜' 
			and dishs_cate!='可口煎菜' and dishs_cate!='开胃炸菜' and dishs_cate!='软烂炖菜' 
			and dishs_cate!='浓香蒸菜' 
	</select>
	<!-- 增加新菜品 -->
	<insert id="insertDishs" parameterType="com.our.pojo.Dishs">
		insert into dishs 
		values(#{dishs_delete},#{dishs_id},#{dishs_name},#{dishs_cate},#{dishs_icon},#{price},#{introduction},#{recommend})
	</insert>
	
	<!-- 下架菜品 -->
	<update id="removeDishs" parameterType="int">
		update dishs set dishs_delete=1 where dishs_id=#{dish_id}
	</update>
	
	<!-- 重新上架菜品 -->
	<update id="restoreDishs" parameterType="int">
		update dishs set dishs_delete=0 where dishs_id=#{dish_id}
	</update>
	
	<!-- 菜品修改 -->
	<update id="updateDishs" parameterType="map">
		update dishs
		<set>
			<if test="dishs_name !=null and dishs_name !='' ">
				dishs_name = #{dishs_name},
			</if>
			<if test="dishs_cate !=null and dishs_cate != '' ">
				dishs_cate = #{dishs_cate},
			</if>
			<if test="dishs_icon !=null and dishs_icon !='' ">
				dishs_icon = #{dishs_icon},
			</if>
			<if test="price !=null and price != -1 ">
				price = #{price},
			</if>
			<if test="introduction !=null and introduction !='' ">
				introduction = #{introduction}
			</if>
		</set>
		where dishs_id = #{dishs_id};
	</update>
	
</mapper>